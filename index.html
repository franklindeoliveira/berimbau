<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Berimbau Player</title>
    <style>
        button {
            width: 50px;
            height: 50px;
        }
        .toque_personalizado_batidas {
            width: 500px;
        }
    </style>
</head>
<body>

    <h1>Toques de Berimbau</h1>
    <p>Toque nas batidas abaixo para ouvir os sons.</p>

    <h2>Batidas (notas)</h2>
    <ul>
        <li><button data-toque="dom">&#128901;</button> dom - Batida com o Dobrão <em>desencostado</em> do Arame</li>
        <li><button data-toque="dim">&#11044;</button> dim - Batida com o Dobrão <em>fortemente</em> encostada no Arame</li>
        <li><button data-toque="tchi">&#10761;</button> tchi - Batida com o Dobrão <em>levemente</em> encostada no Arame</li>
        <li><button data-toque="domchi">&#8855;</button> domchi - Batida "arranhando" o Dobrão no Arame</li>
    </ul>

    Duração da batida

    <h2>Criei seu toque!</h1>
    <p>1s = 1 segundo</p>
    <button id="toque_personalizado">Tocar</button>
    <input id="toque_personalizado_batidas" class="toque_personalizado_batidas" type="text" value="1s tchi, 0.5s tchi, 0.70s dim, 1s dom, 1s dom">
    
    <h2>Toque Angola</h1>
    <button id="toque_angola">Tocar</button>
    <p>&#10761; &#10761; &#8855; &#11044;</p>

    <h2>Toque São Bento Pequeno de Angola</h1>
    <button id="toque_sbp">Tocar</button>
    <p>&#10761; &#10761; &#11044; &#128901;</p>

    <h2>Toque São Bento Grande de Angola</h1>
    <button id="toque_sbg">Tocar</button>
    <button id="toque_sbg_velocidade_menos">-</button>    
    <span id="toque_sbg_velocidade">1x</span>
    <button id="toque_sbg_velocidade_mais">+</button>
    <p>&#10761; &#10761; &#11044; &#128901; &#128901;</p>
    
    <script>
        toque_sbg_velocidade = 1
        toque_sbp_velocidade = 1
        toque_angola_velocidade = 1

        document.querySelector("#toque_sbg_velocidade").textContent = toque_sbg_velocidade

        document.querySelectorAll("[data-toque]").forEach(toque => {
            let audio = new Audio(`audio/${toque.dataset.toque}.mp3`)
            audio.autoPlay = false
            toque.addEventListener("click", function(event) {
                if (event.target.dataset.toque == "dom") {
                    new Audio("audio/dom.mp3").play()
                }
                if (event.target.dataset.toque == "tchi") {
                    new Audio("audio/tchi.mp3").play()
                }
                if (event.target.dataset.toque == "dim") {
                    new Audio("audio/dim.mp3").play()
                }
                if (event.target.dataset.toque == "domchi") {
                    new Audio("audio/domchi.mp3").play()
                }
                event.target.value = ""
            })
        })

        document.querySelector("#toque_personalizado").addEventListener("click", tocar)

        function tocar() {
            let batidasPartes = document.querySelector("#toque_personalizado_batidas").value.split(", ")
            let timeout = 0
            let velocidade = 1.5
            batidasPartes.forEach(batidaParte => {
                let batidaParteSplit = batidaParte.split(" ")
                let batidaParteIntervalo = Number(batidaParteSplit[0].replace("s", ""))
                console.log(batidaParteSplit)
                console.log(batidaParteIntervalo)
                let batidaParteNota = batidaParteSplit[1]
                
                timeout += batidaParteIntervalo * 1000 / velocidade

                if (batidaParteNota == "dom") {
                    setTimeout(tocarDom, timeout)
                }
                if (batidaParteNota == "tchi") {
                    setTimeout(tocarTchi, timeout)
                }
                if (batidaParteNota == "dim") {
                    setTimeout(tocarDim, timeout)
                }
                if (batidaParteNota == "domchi") {
                    setTimeout(tocarDomChi, timeout)
                }
            })
            setTimeout(tocar, timeout)
        }

        document.querySelector("#toque_angola").addEventListener("click", async function(event) {
            let timeout = 0
            setTimeout(tocarTchi, timeout += 500)
            setTimeout(tocarTchi, timeout += 500)
            setTimeout(tocarDomChi, timeout += 500)
            setTimeout(tocarDim, timeout += 1000)
        })

        document.querySelector("#toque_sbp").addEventListener("click", async function(event) {
            let timeout = 0
            setTimeout(tocarTchi, timeout += 500)
            setTimeout(tocarTchi, timeout += 500)
            setTimeout(tocarDim, timeout += 500)
            setTimeout(tocarDom, timeout += 1000)
        })

        document.querySelector("#toque_sbg").addEventListener("click", async function(event) {
            let timeout = 0
            setTimeout(tocarTchi, timeout += 500/toque_sbg_velocidade)
            setTimeout(tocarTchi, timeout += 500/toque_sbg_velocidade)
            setTimeout(tocarDim, timeout += 500/toque_sbg_velocidade)
            setTimeout(tocarDom, timeout += 1000/toque_sbg_velocidade)
            setTimeout(tocarDom, timeout += 1000/toque_sbg_velocidade)
        })

        document.querySelector("#toque_sbg_velocidade_mais").addEventListener("click", async function(event) {
            toque_sbg_velocidade += 0.25
            document.querySelector("#toque_sbg_velocidade").value = toque_sbg_velocidade
            document.querySelector("#toque_sbg_velocidade").textContent = toque_sbg_velocidade
        })

        document.querySelector("#toque_sbg_velocidade_menos").addEventListener("click", async function(event) {
            toque_sbg_velocidade -= 0.25
            document.querySelector("#toque_sbg_velocidade").value = toque_sbg_velocidade
            document.querySelector("#toque_sbg_velocidade").textContent = toque_sbg_velocidade
        })

        function tocarTchi() {
            document.querySelector("[data-toque='tchi']").click()
        }

        function tocarTchi() {
            document.querySelector("[data-toque='tchi']").click()
        }

        function tocarDomChi() {
            document.querySelector("[data-toque='domchi']").click()
        }

        function tocarDim() {
            document.querySelector("[data-toque='dim']").click()
        }

        function tocarDom() {
            document.querySelector("[data-toque='dom']").click()
        }
    </script>
</body>
</html>